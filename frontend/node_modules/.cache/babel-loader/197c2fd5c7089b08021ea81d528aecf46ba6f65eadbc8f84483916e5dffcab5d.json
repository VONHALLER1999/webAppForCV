{"ast":null,"code":"import{useEffect,useMemo,useRef}from\"react\";import*as d3 from\"d3\";import Rectangle from\"./Rectangle.tsx\";import React from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MARGIN={top:30,right:30,bottom:40,left:50};const BUCKET_NUMBER=50;const BUCKET_PADDING=2;export const HistogramSingle=_ref=>{let{width,height,data,domain,groupId}=_ref;const axesRef=useRef(null);const boundsWidth=width-MARGIN.right-MARGIN.left;const boundsHeight=height-MARGIN.top-MARGIN.bottom;// Remove the domain calculation and use the prop directly\nconst xScale=useMemo(()=>{return d3.scaleLinear().domain(domain).range([10,boundsWidth]).nice();},[domain,boundsWidth]);const buckets=useMemo(()=>{const bucketGenerator=d3.bin().value(d=>d).domain(domain).thresholds(xScale.ticks(BUCKET_NUMBER));return bucketGenerator(data);},[xScale,data]);const yScale=useMemo(()=>{const max=Math.max(...buckets.map(bucket=>bucket.length));return d3.scaleLinear().range([boundsHeight,0]).domain([0,max]).nice();},[buckets,height]);// Render axes using D3\nuseEffect(()=>{const svgElement=d3.select(axesRef.current);svgElement.selectAll(\"*\").remove();const xAxisGenerator=d3.axisBottom(xScale);svgElement.append(\"g\").attr(\"transform\",`translate(0,${boundsHeight})`).call(xAxisGenerator);const yAxisGenerator=d3.axisLeft(yScale);svgElement.append(\"g\").call(yAxisGenerator);// Add X axis label\nsvgElement.append(\"text\").attr(\"class\",\"axis-label\").attr(\"text-anchor\",\"middle\").attr(\"x\",boundsWidth/2).attr(\"y\",boundsHeight+MARGIN.bottom-5).text(\"Revenue (DKK)\").style(\"fill\",\"var(--text-light)\");// Add Y axis label\nsvgElement.append(\"text\").attr(\"class\",\"axis-label\").attr(\"text-anchor\",\"middle\").attr(\"transform\",`translate(${-MARGIN.left+15},${boundsHeight/2}) rotate(-90)`).text(\"Frequency\").style(\"fill\",\"var(--text-light)\");},[xScale,yScale,boundsHeight,boundsWidth]);const allRects=buckets.map((bucket,i)=>{const{x0,x1}=bucket;if(x0===undefined||x1===undefined)return null;return/*#__PURE__*/_jsx(Rectangle,{// Use consistent key structure\nx:xScale(x0)+BUCKET_PADDING/2,width:xScale(x1)-xScale(x0)-BUCKET_PADDING,y:yScale(bucket.length),height:boundsHeight-yScale(bucket.length)},`${groupId}_${i}`);});return/*#__PURE__*/_jsxs(\"svg\",{width:width,height:height,children:[/*#__PURE__*/_jsx(\"g\",{transform:`translate(${MARGIN.left},${MARGIN.top})`,children:allRects}),/*#__PURE__*/_jsx(\"g\",{ref:axesRef,transform:`translate(${MARGIN.left},${MARGIN.top})`})]});};export default HistogramSingle;","map":{"version":3,"names":["useEffect","useMemo","useRef","d3","Rectangle","React","jsx","_jsx","jsxs","_jsxs","MARGIN","top","right","bottom","left","BUCKET_NUMBER","BUCKET_PADDING","HistogramSingle","_ref","width","height","data","domain","groupId","axesRef","boundsWidth","boundsHeight","xScale","scaleLinear","range","nice","buckets","bucketGenerator","bin","value","d","thresholds","ticks","yScale","max","Math","map","bucket","length","svgElement","select","current","selectAll","remove","xAxisGenerator","axisBottom","append","attr","call","yAxisGenerator","axisLeft","text","style","allRects","i","x0","x1","undefined","x","y","children","transform","ref"],"sources":["/Users/vilhelmgroenbaek/DevProjects/webAppForCV/frontend/src/HistogramSingle.tsx"],"sourcesContent":["import { useEffect, useMemo, useRef } from \"react\";\nimport * as d3 from \"d3\";\nimport Rectangle from \"./Rectangle.tsx\";\nimport React from \"react\";\n\nconst MARGIN = { top: 30, right: 30, bottom: 40, left: 50 };\nconst BUCKET_NUMBER = 50;\nconst BUCKET_PADDING = 2;\n\ntype HistogramSingleProps = {\n  width: number;\n  height: number;\n  data: number[];\n  domain: [number, number];\n  groupId: string; // Add this prop\n};\n\nexport const HistogramSingle = ({ width, height, data, domain, groupId }: HistogramSingleProps) => {\n  const axesRef = useRef(null);\n  const boundsWidth = width - MARGIN.right - MARGIN.left;\n  const boundsHeight = height - MARGIN.top - MARGIN.bottom;\n    // Remove the domain calculation and use the prop directly\n    const xScale = useMemo(() => {\n      return d3.scaleLinear()\n        .domain(domain)\n        .range([10, boundsWidth])\n        .nice();\n    }, [domain, boundsWidth]);\n\n  const buckets = useMemo(() => {\n    const bucketGenerator = d3\n      .bin()\n      .value((d) => d)\n      .domain(domain)\n      .thresholds(xScale.ticks(BUCKET_NUMBER));\n    return bucketGenerator(data);\n  }, [xScale, data]);\n\n  const yScale = useMemo(() => {\n    const max = Math.max(...buckets.map((bucket) => bucket.length));\n    return d3.scaleLinear().range([boundsHeight, 0]).domain([0, max]).nice();\n  }, [buckets, height]);\n\n  // Render axes using D3\n  useEffect(() => {\n    const svgElement = d3.select(axesRef.current);\n    svgElement.selectAll(\"*\").remove();\n\n    const xAxisGenerator = d3.axisBottom(xScale);\n    svgElement\n      .append(\"g\")\n      .attr(\"transform\", `translate(0,${boundsHeight})`)\n      .call(xAxisGenerator);\n\n    const yAxisGenerator = d3.axisLeft(yScale);\n    svgElement.append(\"g\").call(yAxisGenerator);\n\n    // Add X axis label\n    svgElement\n      .append(\"text\")\n      .attr(\"class\", \"axis-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", boundsWidth / 2)\n      .attr(\"y\", boundsHeight + MARGIN.bottom - 5)\n      .text(\"Revenue (DKK)\")\n      .style(\"fill\", \"var(--text-light)\");\n\n    // Add Y axis label\n    svgElement\n      .append(\"text\")\n      .attr(\"class\", \"axis-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", `translate(${-MARGIN.left + 15},${boundsHeight / 2}) rotate(-90)`)\n      .text(\"Frequency\")\n      .style(\"fill\", \"var(--text-light)\");\n  }, [xScale, yScale, boundsHeight, boundsWidth]);\n\n  const allRects = buckets.map((bucket, i) => {\n    const { x0, x1 } = bucket;\n    if (x0 === undefined || x1 === undefined) return null;\n    return (\n      <Rectangle\n        key={`${groupId}_${i}`} // Use consistent key structure\n        x={xScale(x0) + BUCKET_PADDING / 2}\n        width={xScale(x1) - xScale(x0) - BUCKET_PADDING}\n        y={yScale(bucket.length)}\n        height={boundsHeight - yScale(bucket.length)}\n      />\n    );\n  });\n\n  return (\n    <svg width={width} height={height}>\n      <g transform={`translate(${MARGIN.left},${MARGIN.top})`}>\n        {allRects}\n      </g>\n      <g ref={axesRef} transform={`translate(${MARGIN.left},${MARGIN.top})`} />\n    </svg>\n  );\n};\nexport default HistogramSingle;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}